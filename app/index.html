<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FINE TO DINE - Perfekte Posts in 60 Sekunden</title>
    
    <!-- Favicon & App Icons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iOCIgZmlsbD0iIzhCMjI1MiIvPgo8cGF0aCBkPSJNOSAxMkgxNS41SDIzTDIxIDIwSDExTDkgMTJaIiBmaWxsPSIjRjVGNEYyIi8+CjxjaXJjbGUgY3g9IjE2IiBjeT0iOSIgcj0iMiIgZmlsbD0iI0Y1RjRGMiIvPgo8L3N2Zz4K">
    <link rel="apple-touch-icon" sizes="180x180" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDE4MCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxODAiIGhlaWdodD0iMTgwIiByeD0iNDAiIGZpbGw9IiM4QjIyNTIiLz4KPHBhdGggZD0iTTUwIDY3SDg3SDEzMEwxMTggMTEzSDYyTDUwIDY3WiIgZmlsbD0iI0Y1RjRGMiIvPgo8Y2lyY2xlIGN4PSI5MCIgY3k9IjUwIiByPSIxMiIgZmlsbD0iI0Y1RjRGMiIvPgo8L3N2Zz4K">
    <meta name="theme-color" content="#8B2252">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="FINE TO DINE">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Playfair+Display:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet">
    <style>
        /* üç∑ FINE TO DINE - EINHEITLICHES SCHWEIZER LUXURY DESIGN 2025 */
        
        :root {
            /* === SCHWEIZER UNDERSTATEMENT LUXUS FARBEN === */
            --ftd-primary: #8B2252;         /* Original FINE TO DINE Burgundy */
            --ftd-primary-variant: #A8325F;  /* Heller Burgundy */
            --ftd-primary-dark: #6B1A3F;    /* Dunkler Burgundy */
            
            /* Schweizer Quiet Luxury - subtile Akzente statt "neureich" */
            --swiss-stone: #F5F4F2;         /* Warmer Schweizer Kalkstein */
            --swiss-linen: #FAFAF9;         /* Nat√ºrliches Leinen */
            --swiss-mist: #EBEBEA;          /* Alpen-Nebel */
            --swiss-charcoal: #454545;      /* Zur√ºckhaltende Eleganz */
            
            /* === MODERNE NEUTRALE PALETTE === */
            --neutral-100: #FFFFFF;          /* Pure white */
            --neutral-50: #FEFEFE;           /* Off-white */
            --neutral-25: #FCFCFC;           /* Warm white */
            --neutral-200: #F5F5F5;          /* Light grey */
            --neutral-300: #E8E8E8;          /* Medium light grey */
            --neutral-500: #6B6B6B;          /* Medium grey */
            --neutral-700: #404040;          /* Dark grey */
            --neutral-900: #1A1A1A;          /* Near black */
            
            /* === MATERIAL 3 EXPRESSIVE SURFACES === */
            --surface-primary: rgba(255, 255, 255, 0.95);
            --surface-secondary: rgba(255, 255, 255, 0.85);
            --surface-tertiary: rgba(255, 255, 255, 0.75);
            --surface-variant: rgba(139, 34, 82, 0.04);
            --surface-inverse: var(--neutral-900);
            
            /* === MATERIAL 3 EXPRESSIVE TYPOGRAPHY === */
            --font-brand: 'Playfair Display', serif;    /* Brand & Headlines */
            --font-ui: 'Inter', system-ui, sans-serif;  /* UI & Body */
            
            /* Typography Scale - Material 3 Expressive */
            --text-display-large: 3.5rem;    /* Hero titles */
            --text-display-medium: 2.75rem;  /* Section headers */
            --text-display-small: 2.25rem;   /* Card titles */
            --text-headline-large: 2rem;     /* Page headers */
            --text-headline-medium: 1.75rem; /* Component headers */
            --text-headline-small: 1.5rem;   /* Sub headers */
            --text-title-large: 1.375rem;    /* Important text */
            --text-title-medium: 1.125rem;   /* Standard titles */
            --text-title-small: 0.875rem;    /* Small titles */
            --text-body-large: 1rem;         /* Main body */
            --text-body-medium: 0.875rem;    /* Secondary body */
            --text-body-small: 0.75rem;      /* Caption text */
            
            /* === MATERIAL 3 EXPRESSIVE SPACING === */
            --space-4: 0.25rem;   /* 4px */
            --space-8: 0.5rem;    /* 8px */
            --space-12: 0.75rem;  /* 12px */
            --space-16: 1rem;     /* 16px */
            --space-20: 1.25rem;  /* 20px */
            --space-24: 1.5rem;   /* 24px */
            --space-32: 2rem;     /* 32px */
            --space-40: 2.5rem;   /* 40px */
            --space-48: 3rem;     /* 48px */
            --space-56: 3.5rem;   /* 56px */
            --space-64: 4rem;     /* 64px */
            --space-80: 5rem;     /* 80px */
            
            /* === MATERIAL 3 EXPRESSIVE SHAPE SYSTEM === */
            --shape-extra-small: 0.25rem;    /* 4px */
            --shape-small: 0.5rem;           /* 8px */
            --shape-medium: 0.75rem;         /* 12px */
            --shape-large: 1rem;             /* 16px */
            --shape-extra-large: 1.75rem;    /* 28px */
            --shape-full: 50rem;             /* Full rounded */
            
            /* === MATERIAL 3 EXPRESSIVE ELEVATION === */
            --elevation-1: 0 1px 2px 0 rgba(0, 0, 0, 0.3), 0 1px 3px 1px rgba(0, 0, 0, 0.15);
            --elevation-2: 0 1px 2px 0 rgba(0, 0, 0, 0.3), 0 2px 6px 2px rgba(0, 0, 0, 0.15);
            --elevation-3: 0 4px 8px 3px rgba(0, 0, 0, 0.15), 0 1px 3px 0 rgba(0, 0, 0, 0.3);
            --elevation-4: 0 6px 10px 4px rgba(0, 0, 0, 0.15), 0 2px 3px 0 rgba(0, 0, 0, 0.3);
            --elevation-5: 0 8px 12px 6px rgba(0, 0, 0, 0.15), 0 4px 4px 0 rgba(0, 0, 0, 0.3);
            
            /* === MATERIAL 3 EXPRESSIVE MOTION === */
            --motion-easing-linear: cubic-bezier(0, 0, 1, 1);
            --motion-easing-standard: cubic-bezier(0.2, 0, 0, 1);
            --motion-easing-standard-accelerate: cubic-bezier(0.3, 0, 1, 1);
            --motion-easing-standard-decelerate: cubic-bezier(0, 0, 0, 1);
            --motion-easing-emphasized: cubic-bezier(0.2, 0, 0, 1);
            --motion-easing-emphasized-accelerate: cubic-bezier(0.05, 0.7, 0.1, 1);
            --motion-easing-emphasized-decelerate: cubic-bezier(0.3, 0, 0.8, 0.15);
            --motion-easing-legacy: cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Duration tokens */
            --motion-duration-short1: 50ms;
            --motion-duration-short2: 100ms;
            --motion-duration-short3: 150ms;
            --motion-duration-short4: 200ms;
            --motion-duration-medium1: 250ms;
            --motion-duration-medium2: 300ms;
            --motion-duration-medium3: 350ms;
            --motion-duration-medium4: 400ms;
            --motion-duration-long1: 450ms;
            --motion-duration-long2: 500ms;
            --motion-duration-long3: 550ms;
            --motion-duration-long4: 600ms;
            --motion-duration-extra-long1: 700ms;
            --motion-duration-extra-long2: 800ms;
            --motion-duration-extra-long3: 900ms;
            --motion-duration-extra-long4: 1000ms;
        }
        
        /* === RESET & BASE === */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        html {
            font-size: 16px;
            scroll-behavior: smooth;
            height: 100%;
            -webkit-text-size-adjust: 100%;
        }
        
        /* === EINHEITLICHER BURGUNDY BACKGROUND WIE LOGIN === */
        body {
            font-family: var(--font-ui);
            font-size: var(--text-body-large);
            line-height: 1.5;
            color: var(--neutral-900);
            background: linear-gradient(135deg, 
                var(--ftd-primary-dark) 0%, 
                var(--ftd-primary) 50%, 
                var(--ftd-primary-variant) 100%);
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
            position: relative;
        }
        
        /* === SCHWEIZER ALPEN PATTERN === */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(245, 244, 242, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(245, 244, 242, 0.03) 0%, transparent 50%),
                linear-gradient(135deg, transparent 0%, rgba(245, 244, 242, 0.02) 50%, transparent 100%);
            pointer-events: none;
            z-index: 0;
        }
        
        img, picture, video, canvas, svg {
            display: block;
            max-width: 100%;
        }
        
        input, button, textarea, select {
            font: inherit;
        }
        
        p, h1, h2, h3, h4, h5, h6 {
            overflow-wrap: break-word;
        }
        
        /* === LOADING SCREEN === */
        .auth-loading {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, 
                var(--ftd-primary-dark) 0%, 
                var(--ftd-primary) 70%, 
                var(--ftd-primary-variant) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: var(--space-24);
            z-index: 1000;
        }
        
        .auth-loading.hidden {
            display: none;
        }
        
        .loading-icon {
            background: var(--swiss-stone);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--shape-extra-large);
            width: 5rem;
            height: 5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--ftd-primary);
            font-size: 2.5rem;
            box-shadow: var(--elevation-3);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .loading-text {
            font-family: var(--font-brand);
            font-size: var(--text-headline-large);
            font-weight: 800;
            color: var(--neutral-100);
            margin-bottom: var(--space-8);
            letter-spacing: -0.02em;
        }
        
        .loading-spinner {
            width: 2rem;
            height: 2rem;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid var(--neutral-100);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .auth-loading p {
            color: rgba(255, 255, 255, 0.8);
            font-size: var(--text-body-medium);
        }
        
        /* === MAIN APP CONTAINER === */
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--space-24) var(--space-32);
            min-height: 100vh;
            position: relative;
            opacity: 0;
            transform: translateY(20px);
            transition: all 600ms var(--motion-easing-emphasized-decelerate);
            z-index: 1;
        }
        
        .app-container.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* === SCHWEIZER LUXUS USER HEADER === */
        .user-header {
            position: fixed;
            top: var(--space-24);
            right: var(--space-32);
            display: flex;
            align-items: center;
            gap: var(--space-16);
            background: rgba(45, 25, 35, 0.4);
            backdrop-filter: blur(24px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--shape-extra-large);
            padding: var(--space-16) var(--space-24);
            z-index: 100;
            transition: all var(--motion-duration-medium3) var(--motion-easing-emphasized);
        }
        
        .user-header:hover {
            background: rgba(45, 25, 35, 0.6);
            border-color: rgba(255, 255, 255, 0.15);
            transform: translateY(-1px);
        }
        
        .user-avatar {
            width: 48px;
            height: 48px;
            border-radius: var(--shape-full);
            border: 1px solid rgba(255, 255, 255, 0.2);
            object-fit: cover;
            transition: all var(--motion-duration-medium2) var(--motion-easing-emphasized);
        }
        
        .user-avatar:hover {
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        .user-info {
            color: var(--neutral-100);
        }
        
        .user-name {
            font-weight: 600;
            font-size: var(--text-title-medium);
            margin-bottom: var(--space-4);
        }
        
        .user-email {
            font-size: var(--text-body-small);
            opacity: 0.8;
        }
        
        .logout-button {
            background: rgba(255, 255, 255, 0.08);
            color: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: var(--space-12) var(--space-20);
            border-radius: var(--shape-large);
            font-family: var(--font-ui);
            font-weight: 500;
            font-size: var(--text-body-small);
            cursor: pointer;
            transition: all var(--motion-duration-medium2) var(--motion-easing-emphasized);
            display: flex;
            align-items: center;
            gap: var(--space-8);
        }
        
        .logout-button:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(255, 255, 255, 0.25);
            color: var(--neutral-100);
        }
        
        /* === MAIN GRID === */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-48);
            align-items: start;
            margin-top: var(--space-64);
        }
        
        /* === GLASMORPHISM CARDS WIE LOGIN === */
        .card {
            background: var(--surface-primary);
            backdrop-filter: blur(24px);
            border-radius: var(--shape-extra-large);
            padding: var(--space-40);
            box-shadow: var(--elevation-3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all var(--motion-duration-medium4) var(--motion-easing-emphasized);
            position: relative;
            overflow: hidden;
        }
        
        .card:hover {
            background: rgba(255, 255, 255, 0.98);
            box-shadow: var(--elevation-5);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-4px);
        }
        
        /* Material 3 Expressive: Subtle background pattern */
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, 
                var(--ftd-primary) 0%, 
                var(--swiss-charcoal) 50%, 
                var(--ftd-primary-variant) 100%);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform var(--motion-duration-medium4) var(--motion-easing-emphasized);
        }
        
        .card:hover::before {
            transform: scaleX(1);
        }
        
        /* === HEADER SECTION === */
        .header {
            display: flex;
            align-items: center;
            gap: var(--space-20);
            margin-bottom: var(--space-40);
        }
        
        /* Schweizer Understatement: Subtile Brand Icon */
        .header-icon {
            width: 64px;
            height: 64px;
            background: var(--swiss-stone);
            border: 2px solid rgba(139, 34, 82, 0.15);
            border-radius: var(--shape-large);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--elevation-1);
            transition: all var(--motion-duration-medium2) var(--motion-easing-emphasized);
        }
        
        .header-icon:hover {
            transform: scale(1.05) rotate(2deg);
            box-shadow: var(--elevation-3);
        }
        
        .header-icon .material-symbols-outlined {
            color: var(--ftd-primary);
            font-size: 2rem;
            font-weight: 600;
        }
        
        .header-text h1 {
            font-family: var(--font-brand);
            font-size: var(--text-headline-large);
            font-weight: 800;
            color: var(--ftd-primary);
            letter-spacing: -0.02em;
            margin-bottom: var(--space-4);
        }
        
        /* === BRAND SUBTITLE MIT BADGE WIE LOGIN === */
        .header-text p {
            background: rgba(255, 255, 255, 0.95);
            color: var(--neutral-900);
            font-size: var(--text-body-medium);
            font-weight: 600;
            padding: var(--space-8) var(--space-16);
            border-radius: var(--shape-large);
            border: 1px solid rgba(139, 34, 82, 0.1);
            box-shadow: var(--elevation-1);
            display: inline-block;
            backdrop-filter: blur(8px);
        }
        
        /* === FORM ELEMENTS === */
        .form-group {
            margin-bottom: var(--space-32);
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: var(--neutral-700);
            margin-bottom: var(--space-12);
            font-size: var(--text-title-small);
        }
        
        /* === MATERIAL 3 EXPRESSIVE TEXT INPUT === */
        .form-textarea {
            width: 100%;
            min-height: 320px;
            max-height: 400px;
            padding: var(--space-24);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: var(--shape-large);
            font-family: var(--font-ui);
            font-size: var(--text-body-large);
            line-height: 1.6;
            color: var(--neutral-900);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px);
            resize: vertical;
            transition: all var(--motion-duration-medium2) var(--motion-easing-emphasized);
        }
        
        .form-textarea:focus {
            outline: none;
            border-color: var(--ftd-primary);
            box-shadow: 0 0 0 4px rgba(139, 34, 82, 0.12);
            background: rgba(255, 255, 255, 0.95);
        }
        
        .form-textarea::placeholder {
            color: var(--neutral-500);
            opacity: 0.8;
        }
        
        /* === MATERIAL 3 EXPRESSIVE BUTTONS === */
        .btn-primary {
            width: 100%;
            background: linear-gradient(135deg, 
                var(--ftd-primary) 0%, 
                var(--ftd-primary-variant) 100%);
            color: var(--neutral-100);
            border: none;
            padding: var(--space-20) var(--space-32);
            border-radius: var(--shape-large);
            font-family: var(--font-ui);
            font-size: var(--text-title-medium);
            font-weight: 600;
            cursor: pointer;
            margin-top: var(--space-24);
            transition: all var(--motion-duration-medium3) var(--motion-easing-emphasized);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-12);
            position: relative;
            overflow: hidden;
            box-shadow: var(--elevation-3);
            min-height: 3.5rem;
        }
        
        /* Material 3 Expressive: Shimmer effect */
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.3), 
                transparent);
            transition: left var(--motion-duration-extra-long2) var(--motion-easing-emphasized);
        }
        
        .btn-primary:hover::before {
            left: 100%;
        }
        
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-4px) scale(1.02);
            box-shadow: var(--elevation-5);
        }
        
        .btn-primary:active {
            transform: translateY(-2px) scale(0.98);
        }
        
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: var(--elevation-2);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.9);
            color: var(--ftd-primary);
            border: 2px solid var(--ftd-primary);
            padding: var(--space-12) var(--space-24);
            border-radius: var(--shape-large);
            font-family: var(--font-ui);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--motion-duration-medium2) var(--motion-easing-emphasized);
            display: flex;
            align-items: center;
            gap: var(--space-8);
            font-size: var(--text-body-medium);
            box-shadow: var(--elevation-2);
            backdrop-filter: blur(8px);
        }
        
        .btn-secondary:hover {
            background: var(--ftd-primary);
            color: var(--neutral-100);
            transform: translateY(-2px);
            box-shadow: var(--elevation-4);
        }
        
        .btn-secondary.primary {
            background: var(--swiss-stone);
            color: var(--ftd-primary);
            border: 1px solid rgba(139, 34, 82, 0.2);
        }
        
        .btn-secondary.primary:hover {
            background: var(--swiss-linen);
            color: var(--ftd-primary);
            border-color: var(--ftd-primary);
        }
        
        .btn-icon {
            font-size: 1.25rem;
        }
        
        /* === LOADING STATES === */
        .loading-state {
            display: none;
            text-align: center;
            color: var(--neutral-500);
            font-style: italic;
            padding: var(--space-32);
        }
        
        .loading-state.active {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-16);
        }
        
        .loading-state::after {
            content: '';
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid var(--ftd-primary);
            border-radius: var(--shape-full);
            animation: spin var(--motion-duration-extra-long4) linear infinite;
        }
        
        /* === RESULT SECTION === */
        .result-card {
            opacity: 0;
            transform: translateY(20px);
            transition: all 500ms var(--motion-easing-emphasized-accelerate);
        }
        
        .result-card.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .result-header {
            display: flex;
            align-items: center;
            gap: var(--space-12);
            margin-bottom: var(--space-24);
        }
        
        .result-icon {
            background: linear-gradient(135deg, 
                var(--swiss-stone) 0%, 
                var(--swiss-linen) 100%);
            border-radius: var(--shape-medium);
            width: 2.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--ftd-primary);
            font-size: 1.25rem;
        }
        
        .result-title {
            font-family: var(--font-brand);
            font-size: var(--text-headline-medium);
            font-weight: 700;
            color: var(--ftd-primary);
            margin-bottom: var(--space-24);
            display: flex;
            align-items: center;
            gap: var(--space-12);
        }
        
        .result-title .material-symbols-outlined {
            color: var(--swiss-charcoal);
            font-size: 1.75rem;
            opacity: 0.7;
        }
        
        .result-content {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px);
            border-radius: var(--shape-large);
            padding: var(--space-32);
            border: 1px solid rgba(255, 255, 255, 0.3);
            min-height: 400px;
            font-family: var(--font-ui);
            line-height: 1.7;
            color: var(--neutral-900);
            white-space: pre-wrap;
            margin-bottom: var(--space-24);
            transition: all var(--motion-duration-medium2) var(--motion-easing-emphasized);
        }
        
        .result-content:hover {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: var(--elevation-2);
        }
        
        .result-actions {
            display: flex;
            gap: var(--space-16);
            flex-wrap: wrap;
        }
        
        /* === ERROR MESSAGES === */
        .error-message {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
            padding: var(--space-16);
            border-radius: var(--shape-large);
            margin-top: var(--space-16);
            font-size: var(--text-body-small);
            border: 1px solid rgba(239, 68, 68, 0.2);
            backdrop-filter: blur(8px);
            display: none;
        }
        
        .error-message.active {
            display: block;
            animation: slideIn 300ms var(--motion-easing-emphasized-decelerate);
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* === SUCCESS ANIMATION === */
        .success-animation {
            animation: success-bounce 0.6s var(--motion-easing-emphasized-accelerate);
        }
        
        @keyframes success-bounce {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        /* === RESPONSIVE DESIGN === */
        @media (max-width: 768px) {
            .user-header {
                position: static;
                margin-bottom: var(--space-24);
                justify-content: center;
                top: auto;
                right: auto;
                background: rgba(45, 25, 35, 0.9);
            }
            
            .main-grid {
                grid-template-columns: 1fr;
                padding: var(--space-48) var(--space-20);
                gap: var(--space-32);
                margin-top: var(--space-32);
            }
            
            .app-container {
                padding: var(--space-16);
            }
            
            .card {
                padding: var(--space-32);
            }
            
            .header {
                flex-direction: column;
                text-align: center;
                gap: var(--space-16);
            }
            
            .header-text h1 {
                font-size: var(--text-headline-small);
            }
            
            .result-actions {
                justify-content: center;
            }
        }
        
        @media (max-width: 480px) {
            .app-container {
                padding: var(--space-12);
            }
            
            .card {
                padding: var(--space-24);
            }
            
            .user-header {
                flex-direction: column;
                gap: var(--space-12);
                text-align: center;
            }
        }
        
        /* === ACCESSIBILITY === */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        @media (prefers-contrast: high) {
            .card {
                border: 2px solid var(--ftd-primary);
            }
            
            .btn-primary {
                border: 2px solid var(--neutral-100);
            }
        }
        
        /* === FOCUS INDICATORS === */
        .btn-primary:focus-visible,
        .btn-secondary:focus-visible,
        .logout-button:focus-visible {
            outline: 3px solid var(--swiss-charcoal);
            outline-offset: 2px;
        }
        
        .form-textarea:focus-visible {
            outline: 3px solid var(--swiss-charcoal);
            outline-offset: 2px;
        }
        
        /* === DARK MODE SUPPORT === */
        @media (prefers-color-scheme: dark) {
            :root {
                --surface-primary: rgba(26, 26, 26, 0.95);
                --surface-secondary: rgba(38, 38, 38, 0.85);
                --surface-tertiary: rgba(64, 64, 64, 0.75);
                --neutral-900: #f5f5f5;
                --neutral-700: #d4d4d4;
                --neutral-500: #a3a3a3;
            }
        }
    </style>
</head>
<body>
    <!-- Authentication Loading Screen -->
    <div id="authLoading" class="auth-loading">
        <div class="loading-icon">
            <span class="material-symbols-outlined">restaurant</span>
        </div>
        <div class="loading-text">FINE TO DINE</div>
        <div class="loading-spinner"></div>
        <p>Authentifizierung wird √ºberpr√ºft...</p>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="app-container">
        <!-- User Header -->
        <header id="userHeader" class="user-header">
            <img id="userAvatar" class="user-avatar" src="" alt="User Avatar">
            <div class="user-info">
                <div id="userName" class="user-name"></div>
                <div id="userEmail" class="user-email"></div>
            </div>
            <button id="logoutButton" class="logout-button">
                <span class="material-symbols-outlined" style="font-size: 1rem;">logout</span>
                <span>Abmelden</span>
            </button>
        </header>

        <div class="main-grid">
            <!-- Input Section -->
            <div class="card">
                <div class="header">
                    <div class="header-icon">
                        <span class="material-symbols-outlined">restaurant</span>
                    </div>
                    <div class="header-text">
                        <h1>FINE TO DINE</h1>
                        <p>Perfekte Posts in 60 Sekunden</p>
                    </div>
                </div>

                <form id="postForm">
                    <div class="form-group">
                        <label for="magazinText" class="form-label">Ihr Restaurant-Artikel</label>
                        <textarea 
                            id="magazinText" 
                            name="magazinText" 
                            class="form-textarea" 
                            placeholder="Beschreiben Sie Ihr Restaurant kurz (3-5 S√§tze reichen)&#10;&#10;Z.B.: Das Gasthaus zum L√∂wen bietet seit 1788 authentische Schweizer K√ºche. K√ºchenchef Kevin verw√∂hnt mit regionalen Spezialit√§ten. Perfekt f√ºr besondere Anl√§sse."
                            required></textarea>
                    </div>

                    <button type="submit" class="btn-primary">
                        <span class="material-symbols-outlined btn-icon">auto_awesome</span>
                        <span>Perfekten Post erstellen</span>
                    </button>

                    <div class="loading-state" id="loadingState">
                        <span>Erstelle Ihren perfekten FINE TO DINE Post...</span>
                    </div>

                    <div class="error-message" id="errorMessage"></div>
                </form>
            </div>

            <!-- Result Section -->
            <div class="card result-card" id="resultCard">
                <h2 class="result-title">
                    <span class="material-symbols-outlined">campaign</span>
                    Ihr fertiger Post
                </h2>

                <div class="result-content" id="resultContent">
                    ‚ú® Verwandeln Sie Ihre Restaurant-Geschichte in einen ansprechenden Social Media Post.<br>
                    Einfach Artikel eingeben und "Perfekten Post erstellen" klicken.
                </div>

                <div class="result-actions">
                    <button class="btn-secondary primary" onclick="copyToClipboard()">
                        <span class="material-symbols-outlined">content_copy</span>
                        <span>Kopieren</span>
                    </button>
                    <button class="btn-secondary" onclick="sharePost()">
                        <span class="material-symbols-outlined">share</span>
                        <span>Teilen</span>
                    </button>
                    <button class="btn-secondary" onclick="newPost()">
                        <span class="material-symbols-outlined">refresh</span>
                        <span>N√§chster Post</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.auth0.com/js/auth0-spa-js/2.0/auth0-spa-js.production.js"></script>
    <script type="module">
        // FIXED: Auth0 State Problem gel√∂st
        class ProtectedApp {
            #auth0Client = null;
            #user = null;
            #config = {
                domain: 'dev-j7lkspndihsozye4.eu.auth0.com',
                clientId: 'a8wqmdKF8OgorCzddR6mFmdSdQCf0vmq',
                authorizationParams: {
                    redirect_uri: `${window.location.origin}/app/`
                },
                // CRITICAL: Cache location f√ºr State persistence
                cacheLocation: 'localstorage',
                useRefreshTokens: true
            };
            
            constructor() {
                this.#initializeAuth();
                this.#bindEvents();
            }
            
            async #initializeAuth() {
                try {
                    console.log('üöÄ Starting app initialization...');
                    console.log('Current URL:', window.location.href);
                    
                    this.#auth0Client = await auth0.createAuth0Client(this.#config);
                    console.log('‚úÖ Auth0 client created');
                    
                    // Handle OAuth callback mit verbesserter Error-Behandlung
                    if (window.location.search.includes('code=')) {
                        console.log('üîÑ Handling OAuth callback...');
                        try {
                            await this.#auth0Client.handleRedirectCallback();
                            console.log('‚úÖ Callback handled successfully');
                            // Clean URL after successful callback
                            window.history.replaceState({}, document.title, window.location.pathname);
                        } catch (callbackError) {
                            console.error('‚ùå Callback handling failed:', callbackError);
                            
                            // Bei State-Error: Force neu-authentifizierung
                            if (callbackError.message.includes('Invalid state') || callbackError.message.includes('state')) {
                                console.log('üîß State error detected - forcing re-authentication');
                                // URL cleanen
                                window.history.replaceState({}, document.title, window.location.pathname);
                                // Cache clearen
                                await this.#clearAuth0Cache();
                                // Force login
                                this.#redirectToLogin();
                                return;
                            }
                            throw callbackError;
                        }
                    }
                    
                    // Check authentication status
                    console.log('üîê Checking authentication status...');
                    if (await this.#auth0Client.isAuthenticated()) {
                        console.log('‚úÖ User is authenticated');
                        this.#user = await this.#auth0Client.getUser();
                        this.#showApp();
                    } else {
                        console.log('‚ùå User not authenticated - redirecting to login');
                        this.#redirectToLogin();
                    }
                } catch (error) {
                    console.error('üí• Auth0 initialization failed:', error);
                    await this.#clearAuth0Cache();
                    this.#redirectToLogin();
                }
            }
            
            async #clearAuth0Cache() {
                try {
                    // Auth0 cache clearen
                    const auth0Keys = Object.keys(localStorage).filter(key => 
                        key.startsWith('@@auth0spajs@@') || key.includes('auth0')
                    );
                    auth0Keys.forEach(key => localStorage.removeItem(key));
                    
                    // Session storage auch clearen
                    const sessionKeys = Object.keys(sessionStorage).filter(key => 
                        key.startsWith('@@auth0spajs@@') || key.includes('auth0')
                    );
                    sessionKeys.forEach(key => sessionStorage.removeItem(key));
                    
                    console.log('üßπ Auth0 cache cleared');
                } catch (error) {
                    console.error('Error clearing cache:', error);
                }
            }
            
            #showApp() {
                document.getElementById('authLoading').classList.add('hidden');
                document.getElementById('mainApp').classList.add('visible');
                this.#loadUserProfile();
            }
            
            #redirectToLogin() {
                if ('navigation' in window) {
                    window.navigation.navigate('/login.html');
                } else {
                    window.location.href = '/login.html';
                }
            }
            
            #loadUserProfile() {
                const userAvatar = document.getElementById('userAvatar');
                const userName = document.getElementById('userName');
                const userEmail = document.getElementById('userEmail');
                
                if (this.#user) {
                    userAvatar.src = this.#user.picture || `https://ui-avatars.com/api/?name=${encodeURIComponent(this.#user.name || this.#user.email)}&background=8B2252&color=FFFFFF`;
                    userName.textContent = this.#user.name || this.#user.email;
                    userEmail.textContent = this.#user.email;
                }
            }
            
            #bindEvents() {
                // Logout functionality
                document.getElementById('logoutButton')?.addEventListener('click', async () => {
                    await this.#clearAuth0Cache();
                    this.#auth0Client?.logout({
                        logoutParams: {
                            returnTo: `${window.location.origin}/login.html`
                        }
                    });
                });
                
                // Form submission
                document.getElementById('postForm')?.addEventListener('submit', (e) => this.#handleFormSubmit(e));
            }
            
            async #handleFormSubmit(event) {
                event.preventDefault();
                
                const magazinText = document.getElementById('magazinText')?.value.trim();
                if (!magazinText) {
                    this.#showError('Bitte geben Sie einen Restaurant-Artikel ein.');
                    return;
                }
                
                const submitButton = document.querySelector('button[type="submit"]');
                const loadingState = document.getElementById('loadingState');
                const resultCard = document.getElementById('resultCard');
                const errorMessage = document.getElementById('errorMessage');
                
                // UI Updates
                submitButton.disabled = true;
                loadingState?.classList.add('active');
                resultCard?.classList.remove('visible');
                errorMessage?.classList.remove('active');
                
                try {
                    // Get Auth0 token for secure API call
                    const token = await this.#auth0Client.getTokenSilently();
                    
                    const response = await fetch('/.netlify/functions/generate', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({ magazinText })
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        document.getElementById('resultContent').textContent = data.content;
                        resultCard?.classList.add('visible');
                        resultCard?.classList.add('success-animation');
                        
                        // Remove animation class after completion
                        setTimeout(() => {
                            resultCard?.classList.remove('success-animation');
                        }, 600);
                    } else {
                        this.#showError(data.error || 'Ein Fehler ist aufgetreten.');
                    }
                } catch (error) {
                    console.error('Post generation failed:', error);
                    this.#showError('Verbindungsfehler. Bitte versuchen Sie es erneut.');
                } finally {
                    submitButton.disabled = false;
                    loadingState?.classList.remove('active');
                }
            }
            
            #showError(message) {
                const errorElement = document.getElementById('errorMessage');
                if (errorElement) {
                    errorElement.textContent = message;
                    errorElement.classList.add('active');
                    
                    // Auto-hide after 5 seconds
                    setTimeout(() => {
                        errorElement.classList.remove('active');
                    }, 5000);
                }
            }
        }
        
        // Utility Functions (Global for onclick handlers)
        window.copyToClipboard = async function() {
            const content = document.getElementById('resultContent')?.textContent;
            if (!content || content.includes('Verwandeln Sie Ihre Restaurant-Geschichte')) return;
            
            try {
                await navigator.clipboard.writeText(content);
                const btn = event.target.closest('button');
                const originalHTML = btn.innerHTML;
                btn.innerHTML = '<span class="material-symbols-outlined">done</span><span>Kopiert!</span>';
                btn.classList.add('success-animation');
                setTimeout(() => {
                    btn.innerHTML = originalHTML;
                    btn.classList.remove('success-animation');
                }, 2000);
            } catch (error) {
                console.error('Copy failed:', error);
            }
        };
        
        window.sharePost = function() {
            const content = document.getElementById('resultContent')?.textContent;
            if (!content || content.includes('Verwandeln Sie Ihre Restaurant-Geschichte')) return;
            
            if (navigator.share) {
                navigator.share({
                    title: 'FINE TO DINE Social Media Post',
                    text: content
                }).catch(console.error);
            } else {
                window.copyToClipboard();
            }
        };
        
        window.newPost = function() {
            const magazinText = document.getElementById('magazinText');
            const resultCard = document.getElementById('resultCard');
            const errorMessage = document.getElementById('errorMessage');
            const resultContent = document.getElementById('resultContent');
            
            if (magazinText) magazinText.value = '';
            resultCard?.classList.remove('visible');
            errorMessage?.classList.remove('active');
            
            // Reset result content to placeholder
            if (resultContent) {
                resultContent.innerHTML = '‚ú® Verwandeln Sie Ihre Restaurant-Geschichte in einen ansprechenden Social Media Post.<br>Einfach Artikel eingeben und "Perfekten Post erstellen" klicken.';
            }
            
            magazinText?.focus();
        };
        
        // Initialize App
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => new ProtectedApp());
        } else {
            new ProtectedApp();
        }
    </script>
</body>
</html>